import Table from "react-bootstrap/Table";
import Tabs from "react-bootstrap/Tabs";
import Tab from "react-bootstrap/Tab";
import Row from 'react-bootstrap/Row';
import Col from 'react-bootstrap/Col';

function VulnerabilityDetails({advisory, dependencies, vulnerabilityIds}) {
    console.log(dependencies);
    return (
        <Tabs>
        {advisory.vulnerabilities.filter((vuln) => {
            for(let i = 0; i < dependencies.length; i++) {
                if(vuln.productStatus.has(dependencies[i])) return true;
            }
            return false;
        }).map((vulnerability, index) =>
            <Tab eventKey={"tab"+index} key={"tabid"+index} title={vulnerabilityIds[index]}>
                <br></br>
                <Row>
                    <Col lg="1">{vulnerability.cwe}</Col>
                    <Col lg="11">{vulnerability.description}</Col>
                </Row>
                <br></br>
                {dependencies.map((dep, index) => 
                    <div key={"vuln"+index}> 
                        {(advisory.getProductInformation(dep)).map((info, index) => 
                            <div key={"infoTable"+index}>
                                <h5>{info.fullName}</h5>
                                <Table striped bordered>
                                    <tbody>
                                        <tr>
                                            <td>Version</td>
                                            <td>{info.version}</td>
                                        </tr>
                                        <tr>
                                            <td>Identifier</td>
                                            <td>{info.identifier}</td>
                                        </tr>
                                        <tr>
                                            <td>Status</td>
                                            <td>{info.status}</td>
                                        </tr>
                                        <tr>
                                            <td>CVSS V3</td>
                                            <td>{info.cvss}</td>
                                        </tr>
                                        <tr>
                                            <td>Remediations</td>
                                            <td style={{"w": "unset"}}>{info.remediations.join("\n\n")}</td>
                                        </tr>
                                    </tbody>
                                </Table>
                                <br/>
                            </div>
                        )}
                    </div>
                )}
            </Tab>
        )}
        </Tabs>
    )
}
export default VulnerabilityDetails;